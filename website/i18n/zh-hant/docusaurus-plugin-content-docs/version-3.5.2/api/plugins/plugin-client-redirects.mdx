---
sidebar_position: 4
slug: /api/plugins/@docusaurus/plugin-client-redirects
---

# 📦 plugin-client-redirects

import APITable from '@site/src/components/APITable';

Docusaurus 用於生成**客戶端重定向**的外掛程式。

此外掛程式會將額外的 HTML 頁面寫入您的靜態網站，這些頁面會透過 JavaScript 將使用者重新導向至現有的 Docusaurus 頁面。

:::warning[僅限生產環境]

此外掛程式在開發環境中始終處於非活動狀態，**僅在生產環境中生效**，因為其運作依賴於建置輸出。

:::

:::warning

建議優先使用伺服器端重定向功能。

在使用此外掛程式前，應先確認您的託管服務提供商是否已提供此功能。

:::

## 安裝 {#installation}

```bash npm2yarn
npm install --save @docusaurus/plugin-client-redirects
```

## 配置 {#configuration}

可接受欄位：

```mdx-code-block
<APITable>
```

| Option | Type | Default | Description |
| --- | --- | --- | --- |
| `fromExtensions` | `string[]` | `[]` | The extensions to be removed from the route after redirecting. |
| `toExtensions` | `string[]` | `[]` | The extensions to be appended to the route after redirecting. |
| `redirects` | <code>[RedirectRule](#RedirectRule)[]</code> | `[]` | The list of redirect rules. |
| `createRedirects` | <code>[CreateRedirectsFn](#CreateRedirectsFn)</code> | `undefined` | A callback to create a redirect rule. Docusaurus query this callback against every path it has created, and use its return value to output more paths. |

```mdx-code-block
</APITable>
```

:::note

此外掛程式還會讀取 [`siteConfig.onDuplicateRoutes`](../docusaurus.config.js.mdx#onDuplicateRoutes) 配置，以便在多個檔案被發送到相同位置時調整其日誌級別。

:::

### 類型 {#types}

#### `RedirectRule` {#RedirectRule}

```ts
type RedirectRule = {
  to: string;
  from: string | string[];
};
```

:::note

「來源」與「目標」的概念是此外掛程式的核心。「來源」指您想要建立的路径，即一個將被寫入的額外 HTML 檔案；「目標」則是您想要重新導向至的路径，通常是 Docusaurus 已知的路由。

因此，同一個「目標」可以對應多個「來源」：我們會建立多個 HTML 檔案，這些檔案都會重新導向至同一個目的地。反之，一個「來源」不能對應多個「目標」：寫入的 HTML 檔案必須有確定的目的地。

:::

#### `CreateRedirectsFn` {#CreateRedirectsFn}

```ts
// The parameter `path` is a route that Docusaurus has already created. It can
// be seen as the "to", and your return value is the "from". Returning a falsy
// value will not create any redirect pages for this particular path.
type CreateRedirectsFn = (path: string) => string[] | string | null | undefined;
```

### 配置範例 {#ex-config}

以下是一個配置範例：

```js title="docusaurus.config.js"
export default {
  plugins: [
    [
      '@docusaurus/plugin-client-redirects',
      // highlight-start
      {
        fromExtensions: ['html', 'htm'], // /myPage.html -> /myPage
        toExtensions: ['exe', 'zip'], // /myAsset -> /myAsset.zip (if latter exists)
        redirects: [
          // /docs/oldDoc -> /docs/newDoc
          {
            to: '/docs/newDoc',
            from: '/docs/oldDoc',
          },
          // Redirect from multiple old paths to the new path
          {
            to: '/docs/newDoc2',
            from: ['/docs/oldDocFrom2019', '/docs/legacyDocFrom2016'],
          },
        ],
        createRedirects(existingPath) {
          if (existingPath.includes('/community')) {
            // Redirect from /docs/team/X to /community/X and /docs/support/X to /community/X
            return [
              existingPath.replace('/community', '/docs/team'),
              existingPath.replace('/community', '/docs/support'),
            ];
          }
          return undefined; // Return a falsy value: no redirect created
        },
      },
      // highlight-end
    ],
  ],
};
```