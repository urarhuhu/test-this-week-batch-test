---
id: tutorial
description: This tutorial will walk you through the basics of the Docusaurus i18n system.
slug: /i18n/tutorial
---

# i18n - 教學指南

```mdx-code-block
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
```

本教學將帶您了解 **Docusaurus 國際化系統** 的基本操作。

我們將為 **新初始化的英文版 Docusaurus 網站** 新增 **法文** 翻譯。

使用 `npx create-docusaurus@latest website classic` 初始化新網站（如同 [此範例](https://github.com/facebook/docusaurus/tree/main/examples/classic)）。

## 設定您的網站 {#configure-your-site}

修改 `docusaurus.config.js` 以新增法文語言的國際化支援。

### 網站設定 {#site-configuration}

使用 [網站國際化設定](./../api/docusaurus.config.js.mdx#i18n) 來宣告國際化語言環境：

```js title="docusaurus.config.js"
export default {
  i18n: {
    defaultLocale: 'en',
    locales: ['en', 'fr', 'fa'],
    localeConfigs: {
      en: {
        htmlLang: 'en-GB',
      },
      // You can omit a locale (e.g. fr) if you don't need to override the defaults
      fa: {
        direction: 'rtl',
      },
    },
  },
};
```

語言環境名稱用於翻譯檔案的位置，以及翻譯語言環境的基礎 URL。在建置所有語言環境時，只有預設語言環境的名稱會從基礎 URL 中省略。

Docusaurus 使用語言環境名稱提供 **合理的預設值**：`<html lang="...">` 屬性、語言標籤、日曆格式等。您可以使用 `localeConfigs` 自訂這些預設值。

### 主題設定 {#theme-configuration}

新增一個類型為 `localeDropdown` 的 **導航欄項目**，讓使用者可以選擇他們想要的語言環境：

```js title="docusaurus.config.js"
export default {
  themeConfig: {
    navbar: {
      items: [
        // highlight-start
        {
          type: 'localeDropdown',
          position: 'left',
        },
        // highlight-end
      ],
    },
  },
};
```

:::tip

您可以傳遞一個查詢參數，當使用者使用下拉選單變更語言環境時，該參數會附加到 URL（例如 `queryString: '?persistLocale=true'`）。

這對於在伺服器上實作自動語言環境偵測非常有用。例如，您可以使用此參數將使用者偏好的語言環境儲存在 cookie 中。

:::

### 啟動您的網站 {#start-your-site}

以開發模式啟動您的本地化網站，使用您選擇的語言環境：

```bash npm2yarn
npm run start -- --locale fr
```

您的網站可透過 [`http://localhost:3000/fr/`](http://localhost:3000/fr/) 存取。

我們尚未提供任何翻譯，因此網站大部分內容仍未翻譯。

:::tip

Docusaurus 為通用主題標籤提供 **預設翻譯**，例如分頁的「Next」和「Previous」。

請協助我們完成這些 **[預設翻譯](https://github.com/facebook/docusaurus/tree/main/packages/docusaurus-theme-translations/locales)**。

:::

:::warning

每個語言環境都是 **獨立的單頁應用程式**：無法同時以所有語言環境啟動 Docusaurus 網站。

:::

## 翻譯您的網站 {#translate-your-site}

所有法文語言環境的翻譯資料都儲存在 `website/i18n/fr` 中。每個插件在對應的資料夾下提供自己的翻譯內容，而 `code.json` 檔案則定義 React 程式碼中使用的所有文字標籤。

:::note

在複製檔案後，請使用 `npm run start -- --locale fr` 重新啟動您的網站。編輯現有檔案時，熱重載會更順暢。

:::

### 翻譯您的 React 程式碼 {#translate-your-react-code}

對於您自己編寫的任何 React 程式碼：React 頁面、React 元件等，您將使用 [**翻譯 API**](../docusaurus-core.mdx#translate)。

找出 React 程式碼中所有對使用者可見的文字標籤，並使用翻譯 API 標記它們。有兩種 API：

- `<Translate>` 元件將字串包裝為 JSX 元素；
- `translate()` 回調函式接收訊息並回傳字串。

根據語境語義選擇更適合的形式。例如，`<Translate>` 可作為 React 子元素使用，而對於需要字符串的屬性，則可使用回調函數。

:::warning

JSX 元素是_物件_而非字符串。在需要字符串的上下文中使用（例如 [`<option>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/option) 的子元素）會[強制轉換為字符串](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/toString)，結果將顯示為 `"[object Object]"`。雖然我們鼓勵將 `<Translate>` 作為 JSX 子元素使用，但請僅在確實可行的情況下使用元素形式。

:::

```mdx-code-block
<Tabs>
<TabItem value="Before">
```

```jsx title="src/pages/index.js"
import React from 'react';
import Layout from '@theme/Layout';
import Link from '@docusaurus/Link';

export default function Home() {
  return (
    <Layout>
      {/* highlight-next-line */}
      <h1>Welcome to my website</h1>
      <main>
        {/* highlight-start */}
        You can also visit my
        <Link to="https://docusaurus.io/blog">blog</Link>
        {/* highlight-end */}
        <img
          src="/img/home.png"
          // highlight-next-line
          alt="Home icon"
        />
      </main>
    </Layout>
  );
}
```

```mdx-code-block
</TabItem>
<TabItem value="After">
```

```jsx title="src/pages/index.js"
import React from 'react';
import Layout from '@theme/Layout';
import Link from '@docusaurus/Link';

// highlight-next-line
import Translate, {translate} from '@docusaurus/Translate';

export default function Home() {
  return (
    <Layout>
      <h1>
        {/* highlight-next-line */}
        <Translate>Welcome to my website</Translate>
      </h1>
      <main>
        {/* highlight-start */}
        <Translate
          id="homepage.visitMyBlog"
          description="The homepage message to ask the user to visit my blog"
          values={{
            blogLink: (
              <Link to="https://docusaurus.io/blog">
                <Translate
                  id="homepage.visitMyBlog.linkLabel"
                  description="The label for the link to my blog">
                  blog
                </Translate>
              </Link>
            ),
          }}>
          {'You can also visit my {blogLink}'}
        </Translate>
        {/* highlight-end */}

        <img
          src="/img/home.png"
          alt={
            // highlight-start
            translate({
              message: 'Home icon',
              description: 'The homepage icon alt message',
            })
            // highlight-end
          }
        />
      </main>
    </Layout>
  );
}
```

```mdx-code-block
</TabItem>
</Tabs>
```

:::info

Docusaurus 刻意提供**極簡輕量的翻譯運行時**，僅支援基礎的[佔位符插值](../docusaurus-core.mdx#interpolate)，使用 [ICU 訊息格式](https://formatjs.io/docs/core-concepts/icu-syntax/)的子集。

多數文檔網站本質上是**靜態的**，不需要進階的 i18n 功能（**複數形式**、**性別區分**等）。如需更複雜的使用場景，請使用 [react-intl](https://www.npmjs.com/package/react-intl) 這類函式庫。

:::

`docusaurus write-translations` 命令會靜態分析您網站中使用的所有 React 程式碼文件，提取這些 API 的調用，並將其匯總到 `code.json` 文件中。翻譯文件將以從 ID 到翻譯訊息物件（包括翻譯後的標籤和標籤描述）的映射形式存儲。在調用翻譯 API（`<Translate>` 或 `translate()`）時，您需要指定未翻譯的默認訊息或 ID，以便 Docusaurus 正確將每個翻譯條目與 API 調用關聯起來。

:::warning[文字標籤必須是靜態的]

`docusaurus write-translations` 命令僅對您的程式碼進行**靜態分析**，不會實際運行您的網站。因此，無法提取動態訊息，因為訊息是_表達式_而非_字符串_：

```jsx
const items = [
  {id: 1, title: 'Hello'},
  {id: 2, title: 'World'},
];

function ItemsList() {
  return (
    <ul>
      {/* 請勿這樣做：無法與 write-translations 命令配合使用 */}
      {items.map((item) => (
        <li key={item.id}>
          <Translate>{item.title}</Translate>
        </li>
      ))}
    <ul>
  );
}
```

這在運行時仍能正常運作。然而，未來我們可能會提供「無運行時」機制，通過 Babel 轉換直接將翻譯內聯到 React 程式碼中，而非在運行時調用 API。因此，為確保未來兼容性，您應始終偏好靜態可分析的訊息。例如，我們可以重構上述程式碼為：

```jsx
const items = [
  {id: 1, title: <Translate>Hello</Translate>},
  {id: 2, title: <Translate>World</Translate>},
];

function ItemsList() {
  return (
    <ul>
      {/* 渲染時標題已翻譯完成！ */}
      {items.map((item) => (
        <li key={item.id}>{item.title}</li>
      ))}
    <ul>
  );
}
```

您可以將翻譯 API 的調用視為純粹的_標記器_，用於告知 Docusaurus「此處的文字標籤需替換為翻譯後的訊息」。

:::

#### 複數形式 {#pluralization}

執行 `write-translations` 時，您會注意到部分標籤已處理為複數形式：

```json title="i18n/en/code.json"
{
  // ...
  "theme.blog.post.plurals": "One post|{count} posts"
  // ...
}
```

每種語言都會有一組[可能的複數類別](https://unicode-org.github.io/cldr-staging/charts/37/supplemental/language_plural_rules.html)。Docusaurus 會按照 `["zero", "one", "two", "few", "many", "other"]` 的順序排列這些類別。例如，英語 (`en`) 有兩種複數形式（"one" 和 "other"），翻譯訊息會用管道符 (`|`) 分隔兩個標籤。波蘭語 (`pl`) 有三種複數形式（"one"、"few" 和 "many"），則需要按順序提供三個用管道符連接的標籤。

您也可以為自己的程式碼訊息實現複數化：

```jsx
import {translate} from '@docusaurus/Translate';
import {usePluralForm} from '@docusaurus/theme-common';

function ItemsList({items}) {
  // `usePluralForm` will provide the plural selector for the current locale
  const {selectMessage} = usePluralForm();
  // Select the appropriate pluralized label based on `items.length`
  const message = selectMessage(
    items.length,
    translate(
      {message: 'One item|{count} items'},
      {count: items.length},
    ),
  );
  return (
    <>
      <h2>{message}</h2>
      <ul>{items.map((item) => <li key={item.id}>{item.title}</li>)}<ul>
    </>
  );
}
```

:::note

Docusaurus 使用 [`Intl.PluralRules`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/PluralRules) 來解析和選擇複數形式。必須按照正確順序提供正確數量的複數形式，才能讓 `selectMessage` 正常運作。

:::

### 翻譯插件數據 {#translate-plugin-data}

JSON 翻譯文件用於處理程式碼中所有需要國際化的內容：

- React 程式碼，包括您標記的翻譯標籤
- 主題配置中的導覽列和頁尾標籤
- `sidebars.js` 中的文檔側邊欄分類標籤
- 插件選項中的部落格側邊欄標題
- ...

執行 [write-translations](../cli.mdx#docusaurus-write-translations-sitedir) 命令：

```bash npm2yarn
npm run write-translations -- --locale fr
```

該命令會提取並初始化需要翻譯的 JSON 翻譯文件。根目錄下的 `code.json` 包含從原始碼中提取的所有翻譯 API 呼叫，這些可能是您編寫的或由主題提供的，其中部分可能已預設翻譯完成。

```json title="i18n/fr/code.json"
{
  // No ID for the <Translate> component: the default message is used as ID
  "Welcome to my website": {
    "message": "Welcome to my website"
  },
  "home.visitMyBlog": {
    "message": "You can also visit my {blog}",
    "description": "The homepage message to ask the user to visit my blog"
  },
  "homepage.visitMyBlog.linkLabel": {
    "message": "Blog",
    "description": "The label for the link to my blog"
  },
  "Home icon": {
    "message": "Home icon",
    "description": "The homepage icon alt message"
  }
}
```

插件和主題也會生成自己的 JSON 翻譯文件，例如：

```json title="i18n/fr/docusaurus-theme-classic/navbar.json"
{
  "title": {
    "message": "My Site",
    "description": "The title in the navbar"
  },
  "item.label.Docs": {
    "message": "Docs",
    "description": "Navbar item with label Docs"
  },
  "item.label.Blog": {
    "message": "Blog",
    "description": "Navbar item with label Blog"
  },
  "item.label.GitHub": {
    "message": "GitHub",
    "description": "Navbar item with label GitHub"
  }
}
```

翻譯 `i18n/fr` 中 JSON 文件的 `message` 屬性後，您的網站佈局和首頁現在應該已完成翻譯。

### 翻譯 Markdown 文件 {#translate-markdown-files}

官方 Docusaurus 內容插件廣泛使用 Markdown/MDX 文件，並允許您進行翻譯。

#### 翻譯文檔 {#translate-the-docs}

將文檔 Markdown 文件從 `docs/` 複製到 `i18n/fr/docusaurus-plugin-content-docs/current` 並進行翻譯：

```bash
mkdir -p i18n/fr/docusaurus-plugin-content-docs/current
cp -r docs/** i18n/fr/docusaurus-plugin-content-docs/current
```

:::info

請注意，`docusaurus-plugin-content-docs` 插件總是按版本劃分內容。`./docs` 文件夾中的數據會在 `current` 子文件夾和 `current.json` 文件中進行翻譯。有關 "current" 含義的更多信息，請參閱[文檔版本控制指南](../guides/docs/versioning.mdx#terminology)。

:::

#### 翻譯部落格 {#translate-the-blog}

將部落格 Markdown 文件複製到 `i18n/fr/docusaurus-plugin-content-blog` 並進行翻譯：

```bash
mkdir -p i18n/fr/docusaurus-plugin-content-blog
cp -r blog/** i18n/fr/docusaurus-plugin-content-blog
```

#### 翻譯頁面 {#translate-the-pages}

將頁面 Markdown 文件複製到 `i18n/fr/docusaurus-plugin-content-pages` 並進行翻譯：

```bash
mkdir -p i18n/fr/docusaurus-plugin-content-pages
cp -r src/pages/**.md i18n/fr/docusaurus-plugin-content-pages
cp -r src/pages/**.mdx i18n/fr/docusaurus-plugin-content-pages
```

:::warning

我們只複製 `.md` 和 `.mdx` 文件，因為 React 頁面已通過 JSON 翻譯文件完成翻譯。

:::

:::tip[Use explicit heading IDs]

By default, a Markdown heading `### Hello World` will have a generated ID `hello-world`. Other documents can link it with `[link](#hello-world)`. However, after translation, the heading becomes `### Bonjour le Monde`, with ID `bonjour-le-monde`.

Generated IDs are not always a good fit for localized sites, as it requires you to localize all the anchor links:

```diff
- [link](#hello-world).
+ [link](#bonjour-le-monde)
```

For localized sites, it is recommended to use **[explicit heading IDs](../guides/markdown-features/markdown-features-toc.mdx#heading-ids)**.

:::

## Deploy your site {#deploy-your-site}

You can choose to deploy your site under a **single domain** or use **multiple (sub)domains**.

### Single-domain deployment {#single-domain-deployment}

Run the following command:

```bash npm2yarn
npm run build
```

Docusaurus will build **one single-page application per locale**:

- `website/build`: for the default, English language
- `website/build/fr`: for the French language

You can now [deploy](../deployment.mdx) the `build` folder to the static hosting solution of your choice.

:::note

The Docusaurus website uses this strategy:

- [`https://docusaurus.io`](https://docusaurus.io)
- [`https://docusaurus.io/fr`](https://docusaurus.io/fr)

:::

:::tip

Static hosting providers generally redirect `/unknown/url` to `/404.html` by convention, always showing an **English 404 page**.

**Localize your 404 pages** by configuring your host to redirect `/fr/*` to `/fr/404.html`.

This is not always possible, and depends on your host: GitHub Pages can't do this, [Netlify](https://docs.netlify.com/routing/redirects/redirect-options/#custom-404-page-handling) can.

:::

### Multi-domain deployment {#multi-domain-deployment}

You can also build your site for a single locale:

```bash npm2yarn
npm run build -- --locale fr
```

Docusaurus will not add the `/fr/` URL prefix.

On your [static hosting provider](../deployment.mdx):

- create one deployment per locale
- configure the appropriate build command, using the `--locale` option
- configure the (sub)domain of your choice for each deployment

:::warning

This strategy is **not possible** with GitHub Pages, as it is only possible to **have a single deployment**.

:::

### Hybrid {#hybrid}

It is possible to have some locales using sub-paths, and others using subdomains.

It is also possible to deploy each locale as a separate subdomain, assemble the subdomains in a single unified domain at the CDN level:

- Deploy your site as `fr.docusaurus.io`
- Configure a CDN to serve it from `docusaurus.io/fr`

## Managing translations {#managing-translations}

Docusaurus doesn't care about how you manage your translations: all it needs is that all translation files (JSON, Markdown, or other data files) are available in the file system during building. However, as site creators, you would need to consider how translations are managed so your translation contributors could collaborate well.

We will share two common translation collaboration strategies: [**using git**](./i18n-git.mdx) and [**using Crowdin**](./i18n-crowdin.mdx).