---
slug: /migration/v2/translated-sites
---

# Translated sites

This page explains how migrate a translated Docusaurus v1 site to Docusaurus v2.

## i18n differences {#i18n-differences}

Docusaurus v2 i18n is conceptually quite similar to Docusaurus v1 i18n with a few differences.

It is not tightly coupled to Crowdin, and you can use Git or another SaaS instead.

### Different filesystem paths {#different-filesystem-paths}

On Docusaurus v2, localized content is generally found at `website/i18n/[locale]`.

Docusaurus v2 is modular based on a plugin system, and each plugin is responsible to manage its own translations.

Each plugin has its own i18n subfolder, like: `website/i18n/fr/docusaurus-plugin-content-blog`

### Updated translation APIs {#updated-translation-apis}

With Docusaurus v1, you translate your pages with `<translate>`:

```jsx
const translate = require('../../server/translate.js').translate;

<h2>
  <translate desc="the header description">
    This header will be translated
  </translate>
</h2>;
```

On Docusaurus v2, you translate your pages with `<Translate>`

```jsx
import Translate from '@docusaurus/Translate';

<h2>
  <Translate id="header.translation.id" description="the header description">
    This header will be translated
  </Translate>
</h2>;
```

:::note

The `write-translations` CLI still works to extract translations from your code.

The code translations are now added to `i18n/[locale]/code.json` using Chrome i18n JSON format.

:::

### Stricter Markdown parser {#stricter-markdown-parser}

Docusaurus v2 is using [MDX](https://mdxjs.com/) to parse Markdown files.

MDX compiles Markdown files to React components, is stricter than the Docusaurus v1 parser, and will make your build fail on error instead of rendering some bad content.

Also, the HTML elements must be replaced by JSX elements.

This is particularly important for i18n because if your translations are not good on Crowdin and use invalid Markup, your v2 translated site might fail to build: you may need to do some translation cleanup to fix the errors.

## Migration strategies {#migration-strategies}

This section will help you figure out how to **keep your existing v1 translations after you migrate to v2**.

There are **multiple possible strategies** to migrate a Docusaurus v1 site using Crowdin, with different tradeoffs.

:::warning

This documentation is a best-effort to help you migrate, please help us improve it if you find a better way!

:::

Before all, we recommend to:

- Migrate your v1 Docusaurus site to v2 without the translations
- Get familiar with the [new i18n system of Docusaurus v2](../../i18n/i18n-introduction.mdx) an
- Make Crowdin work for your v2 site, using a new and untranslated Crowdin project and the [Crowdin tutorial](../../i18n/i18n-crowdin.mdx)

:::danger

Don't try to migrate without understanding both Crowdin and Docusaurus v2 i18n.

:::

### Create a new Crowdin project {#create-a-new-crowdin-project}

To avoid any **risk of breaking your v1 site in production**, one possible strategy is to duplicate the original v1 Crowdin project.

:::info

This strategy was used to [upgrade the Jest website](https://jestjs.io/blog/2021/03/09/jest-website-upgrade).

:::

Unfortunately, Crowdin does not have any "Duplicate/clone Project" feature, which makes things complicated.

- 從原始專案下載翻譯記憶庫（`.tmx`格式）（`https://crowdin.com/project/<ORIGINAL_PROJECT>/settings#tm` > `View Records`）
- 將翻譯記憶庫上傳至新專案（`https://crowdin.com/project/<NEW_PROJECT>/settings#tm` > `View Records`）
- 根據i18n文件重新配置`crowdin.yml`以適應Docusaurus v2
- 使用Crowdin CLI將Docusaurus v2源文件上傳至新專案
- 在Crowdin上將敏感字串如`id`或`slug`標記為「隱藏字串」
- 在「Translations」標籤頁，點擊「Pre-Translation > via TM」（`https://crowdin.com/project/<NEW_PROJECT>/settings#translations`）
- 先嘗試「100% match」（比「Perfect」會翻譯更多內容），並預翻譯你的源文件
- 下載Crowdin翻譯至本地
- 嘗試運行/建置你的網站，查看是否有錯誤

首次嘗試時很可能會遇到錯誤：預翻譯可能會嘗試翻譯不應翻譯的內容（front matter、admonition、代碼區塊等），且翻譯後的MD文件可能對MDX解析器無效。

你必須修復所有錯誤，直到網站能成功建置。可以通過修改本地翻譯後的MD文件來解決，並使用`docusaurus build --locale fr`一次修復一個語系的網站。

我們無法提供修復這些錯誤的終極指南，但常見錯誤原因包括：

- 未在Crowdin中將足夠字串標記為「隱藏字串」，導致預翻譯嘗試翻譯這些字串。
- 存在不良的v1翻譯，導致v2中出現無效標記：翻譯中包含不良HTML元素和未閉合標籤
- 任何被MDX解析器拒絕的內容，例如使用HTML元素而非JSX元素（使用[MDX playground](https://mdxjs.com/playground/)進行除錯）

你可能需要重複此預翻譯流程，最終嘗試「Perfect」選項並限制僅對某些語言/文件進行預翻譯。

:::tip

在問題Markdown元素周圍使用[`mdx-code-block`](../../i18n/i18n-crowdin.mdx#mdx-solutions)：Crowdin較不容易弄亂代碼區塊內的內容。

:::

:::note

你可能會注意到舊專案中某些已翻譯的內容，在新專案中卻未翻譯。

Crowdin的Markdown解析器會隨時間演進，且每個Crowdin專案的解析器版本可能不同，這可能導致預翻譯無法翻譯所有字串。

此解析器版本未公開記錄，你需要聯繫Crowdin支援以了解專案的解析器版本並固定特定版本。

在兩個Crowdin專案中使用相同的CLI版本和解析器版本可能會獲得更好的結果。

:::

:::danger

Crowdin有「上傳翻譯」功能，但根據我們的經驗，這對Markdown的效果不佳

:::

### 使用現有Crowdin專案 {#use-the-existing-crowdin-project}

如果你不介意修改現有Crowdin專案並承擔搞砸的風險，可以嘗試使用Crowdin的分支系統。

:::warning

此工作流程尚未經過實際測試，請向我們回報其效果。

:::

這樣你就不需要創建新Crowdin專案、轉移翻譯記憶庫、應用預翻譯並嘗試修復預翻譯錯誤。

你可以為Docusaurus v2創建一個Crowdin分支，上傳v2源文件，並在準備好後將分支合併至主分支。

### 使用Git替代Crowdin {#use-git-instead-of-crowdin}

可以完全遷移出Crowdin，將翻譯文件加入Git管理。

使用Crowdin CLI下載v1翻譯文件，並將這些翻譯文件放置於Docusaurus v2正確的文件系統位置。