---
id: multi-instance
description: Use multiple docs plugin instances on a single Docusaurus site.
slug: /docs-multi-instance
---

# 多實例文件

`@docusaurus/plugin-content-docs` 插件支援 [多實例](../../using-plugins.mdx#multi-instance-plugins-and-plugin-ids) 功能。

:::note

此功能僅對 [版本化文件](./versioning.mdx) 有用。建議在閱讀本頁前先熟悉文件版本化功能。若您僅需要 [多側邊欄](./sidebar/multiple-sidebars.mdx)，可在單一插件內實現。

:::

## 使用情境 {#use-cases}

有時您會希望一個 Docusaurus 站台能托管兩套（或更多）獨立的文件集。

這些文件集甚至可能擁有不同的版本化/發布週期。

### 行動 SDK 文件 {#mobile-sdks-documentation}

若您開發跨平台行動 SDK，可能會擁有兩套文件：

- Android SDK 文件 (`v1.0`, `v1.1`)
- iOS SDK 文件 (`v1.0`, `v2.0`)

此情況下，可為每個行動 SDK 文件使用獨立的插件實例。

:::warning

若每個文件實例體量龐大，您應考慮建立兩個獨立的 Docusaurus 站台。

當有人編輯 iOS 文件時，真的有必要重新建置所有內容（包括未變更的完整 Android 文件）嗎？

:::

### 版本化與非版本化文件 {#versioned-and-unversioned-doc}

有時您會希望部分文件進行版本化，而其他「全局性」文件則無需版本控制。

我們在 Docusaurus 官方網站就採用此模式：

- [/docs/\*](/docs) 區段為版本化內容
- [/community/\*](/community/support) 區段為非版本化內容

## 設定方式 {#setup}

假設您有兩套文件：

- 產品：關於產品的版本化文件
- 社群：關於產品周邊社群的未版本化文件

此情況下，您應在站台配置中重複使用同個插件兩次。

:::warning

`@docusaurus/preset-classic` 已預設包含一個文件插件實例！

:::

使用預設配置時：

```js title="docusaurus.config.js"
export default {
  presets: [
    [
      '@docusaurus/preset-classic',
      {
        docs: {
          // highlight-start
          // id: 'product', // omitted => default instance
          // highlight-end
          path: 'product',
          routeBasePath: 'product',
          sidebarPath: './sidebarsProduct.js',
          // ... other options
        },
      },
    ],
  ],
  plugins: [
    [
      '@docusaurus/plugin-content-docs',
      {
        // highlight-start
        id: 'community',
        // highlight-end
        path: 'community',
        routeBasePath: 'community',
        sidebarPath: './sidebarsCommunity.js',
        // ... other options
      },
    ],
  ],
};
```

不使用預設配置時：

```js title="docusaurus.config.js"
export default {
  plugins: [
    [
      '@docusaurus/plugin-content-docs',
      {
        // highlight-start
        // id: 'product', // omitted => default instance
        // highlight-end
        path: 'product',
        routeBasePath: 'product',
        sidebarPath: './sidebarsProduct.js',
        // ... other options
      },
    ],
    [
      '@docusaurus/plugin-content-docs',
      {
        // highlight-start
        id: 'community',
        // highlight-end
        path: 'community',
        routeBasePath: 'community',
        sidebarPath: './sidebarsCommunity.js',
        // ... other options
      },
    ],
  ],
};
```

請記得為插件實例分配唯一的 `id` 屬性。

:::note

我們將 `product` 實例視為最重要者，透過不分配 ID 使其成為「預設」實例。

:::

## 版本化路徑 {#versioned-paths}

每個插件實例會將版本化文件儲存在獨立目錄。

預設插件實例使用以下路徑：

- `website/versions.json`
- `website/versioned_docs`
- `website/versioned_sidebars`

其他插件實例（帶有 `id` 屬性者）則使用以下路徑：

- `website/[pluginId]_versions.json`
- `website/[pluginId]_versioned_docs`
- `website/[pluginId]_versioned_sidebars`

:::tip

您可為其中一個文件插件實例省略 `id` 屬性（預設為 `default`）。

該實例路徑會更簡潔，並與單實例設定保持回溯相容性。

:::

## 標記新版本 {#tagging-new-versions}

每個插件實例都有專屬的 CLI 指令來標記新版本。執行以下命令即可顯示：

```bash npm2yarn
npm run docusaurus -- --help
```

若要為產品/預設文件插件實例進行版本控制：

```bash npm2yarn
npm run docusaurus docs:version 1.0.0
```

若要為非預設/社群文件插件實例進行版本控制：

```bash npm2yarn
npm run docusaurus docs:version:community 1.0.0
```

## 文件導航欄項目 {#docs-navbar-items}

每個與文件相關的[主題導航欄項目](../../api/themes/theme-configuration.mdx#navbar)都可選用 `docsPluginId` 屬性。

舉例來說，若您希望為每個行動 SDK（iOS 和 Android）各設置一個版本下拉選單，可以這樣做：

```js title="docusaurus.config.js"
export default {
  themeConfig: {
    navbar: {
      items: [
        {
          type: 'docsVersionDropdown',
          // highlight-start
          docsPluginId: 'ios',
          // highlight-end
        },
        {
          type: 'docsVersionDropdown',
          // highlight-start
          docsPluginId: 'android',
          // highlight-end
        },
      ],
    },
  },
};
```